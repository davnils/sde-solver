Konstruera abstraktion som knyter samman MPI och Accelerate.

Delade operationer:

transport av indata, beräkning, mellanliggande beräkningar, transport av resultat

Control.Arrow? verkar alltför begränsad.

Flera instanser ska kunna kedjas för att t.ex. först sprida beräkningar över ett kluster och sedan över flera GPUer.
Exempel:

MPI-in -> Accelerate-in -> beräkning på indata -> Accelerate-ut -> MPI-ut

Kan det ses som att första input hanterar en funktion av samma typ som alla inputs och själva beräkningen?
Handlar det bara om att KÖRA ett program och ge det indata, samt hantera utdatan?

----> Defines an operator that composes calculations that are instances of Distributed. <-----
      Alternative: the actual Distributed class can contain composition.

data MPI = MPI
data Accelerate = Accelerate
-- MPI (Accelerate (Bottom f))

class Distributed m where
	send :: 
	gather :: 

f <=> g = out f 
f (mpi <=> acc)

compute () = 
compute Eval = 

compute f in = do
	in' <- mpi_distribute in
	in'' <- accelerate_send in'
	out <- f in''
	out' <- accelerate_recv out
	out'' <- mpi_gather out'
	return out''

class Distributed a where
        execute :: Distributed m => a -> b -> m b

data MPI = MPI { servers :: [String] }

data Accelerate = Accelerate { gpus :: [Int] }

instance Distributed MPI where
        execute settings input = ...

instance Distributed Accelerate where
        execute settings input = ...

executeSolver = do
        let calculation = ...
            acc = Accelerate ...
            mpi = MPI ...
        execute MPI acc
